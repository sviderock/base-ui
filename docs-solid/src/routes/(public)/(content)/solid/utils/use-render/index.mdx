# useRender

<Subtitle>Hook for enabling a render prop in custom components.</Subtitle>

<Meta name="description" content="Hook for enabling a render prop in custom components." />

The `useRender` hook lets you build custom components that provide a `render` prop to override the default rendered element.

## API reference

### Input parameters

<PropsReferenceTable
  data={{
    render: {
      type: 'RenderProp<State>',
      description:
        'The React element or a function that returns one to override the default element.',
    },
    props: {
      type: 'Record<string, unknown>',
      description:
        'Props to be spread on the rendered element.\n\nThey are merged with the internal props\n of the component, so that event handlers are merged,\n`className` strings and `style` properties are joined, and other external props overwrite the internal ones.',
    },
    ref: {
      type: 'React.Ref<RenderedElementType> | React.Ref<RenderedElementType>[]',
      description: 'The refs to apply to the rendered element.',
    },
    state: {
      type: 'State',
      description:
        'The state of the component. It will be used as a parameter for the render callback.',
    },
  }}
/>

### Return value

<PropsReferenceTable
  type="return"
  data={{
    element: {
      type: 'React.ReactElement',
      description: 'The rendered React element',
    },
  }}
/>

```tsx title="Usage"
const element = useRender({
  // Input parameters
});
```

## Examples

A `render` prop for a custom Text component lets consumers use it to replace the default rendered `p` element with a different tag or component.

<Demo path="./demos/render" />

The callback version of the `render` prop enables more control of how props are spread, and also passes the internal `state` of a component.

<Demo path="./demos/render-callback" />

## Merging props

The `mergeProps` function merges two or more sets of React props together. It safely merges three types of props:

1. Event handlers, so that all are invoked
2. `className` strings
3. `style` properties

`mergeProps` merges objects from left to right, so that subsequent objects' properties in the arguments overwrite previous ones. Merging props is useful when creating custom components, as well as inside the callback version of the `render` prop for any Base UI component.

```tsx title="Using mergeProps in the render callback"
import { mergeProps } from '@msviderok/base-ui-solid/merge-props';
import styles from './index.module.css';

function Button() {
  return (
    <Component
      render={(props, state) => (
        <button
          {...mergeProps<'button'>(props, {
            class: styles.Button,
          })}
        />
      )}
    />
  );
}
```

## Merging refs

When building custom components, you often need to control a ref internally while still letting external consumers pass their ownâ€”merging refs lets both parties have access to the underlying DOM element. The `ref` option in `useRender` enables this, which holds an array of refs to be merged together.

In React 19, `React.forwardRef()` is not needed when building primitive components, as the external ref prop is already contained inside `props`. Your internal ref can be passed to `ref` to be merged with `props.ref`:

```tsx title="React 19" {5} "internalRef"
function Text(props: TextProps) {
  const [local, otherProps] = splitProps(props, ['render']);
  let internalRef: HTMLElement | undefined;

  const element = useRender({
    ref: internalRef,
    props,
    get render() {
      return local.render ?? 'p';
    },
  });

  return element;
}
```

## TypeScript

To type props, there are two interfaces:

- `useRender.ComponentProps` for a component's external (public) props. It types the `render` prop and HTML attributes.
- `useRender.ElementProps` for the element's internal (private) props. It types HTML attributes alone.

```tsx title="Typing props" {1,4}
interface ButtonProps extends useRender.ComponentProps<'button'> {}

function Button(props: ButtonProps) {
  const [local, otherProps] = splitProps(props, ['render']);
  const defaultProps: useRender.ElementProps<'button'> = {
    class: styles.Button,
    type: 'button',
    children: 'Click me',
  };

  const element = useRender({
    get render() {
      return local.render ?? 'button';
    },
    props: mergeProps<'button'>(defaultProps, otherProps),
  });

  return element;
}
```

In Base UI, `useRender` lets you implement a `render` prop. The example below is the equivalent implementation to the Radix example above.

```jsx title="Base UI render prop"
import { useRender } from '@msviderok/base-ui-solid/use-render';

function Button(props: ButtonProps) {
  const [local, otherProps] = splitProps(props, ['render']);
  const render = () => local.render ?? 'button';
  return useRender({
    get render() {
      return render()
    },
    props: otherProps,
  });
}

// Usage (all of the following are valid):
<Button render={(props) => <a href="/contact" {...props}>Contact</a>} />;
<Button render={(props) => <a href="/contact" {...props} />}>Contact</Button>;
<Button render={{ component: 'a', href: '/contact', children: 'Contact' }} />;
<Button render={{ component: 'a', href: '/contact' }}>Contact</Button>;
<Button render='a' href='/contact'>Contact</Button>;
```
